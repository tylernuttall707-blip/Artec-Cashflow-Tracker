<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cash Flow Forecaster — 2025</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo"></div>
      <div>
        <h1>Cash Flow Forecaster — 2025</h1>
        <div class="sub">Local-only • Single-file • Offline ready</div>
      </div>
    </div>
    <div class="header-actions">
      <div class="tabs">
        <button class="tab-btn active" data-tab="dashboard">Dashboard</button>
        <button class="tab-btn" data-tab="expenses">Expenses / One-offs</button>
        <button class="tab-btn" data-tab="income">Income</button>
      </div>
      <button class="theme-toggle" id="toggleTheme" type="button" aria-pressed="false">☀️ Light mode</button>
    </div>
  </header>

  <main>
    <!-- DASHBOARD -->
    <section class="tab active" id="dashboard">
      <div class="grid cols-3">
        <div class="card">
          <h3>Settings</h3>
          <div class="row">
            <label class="small">Start Balance</label>
            <input id="startBalance" type="number" step="0.01" placeholder="0.00"/>
            <label class="small">Start Date</label>
            <input id="startDate" type="date"/>
            <label class="small">End Date</label>
            <input id="endDate" type="date"/>
            <button class="primary" id="saveSettings">Save</button>
          </div>
          <div class="spacer"></div>
          <div class="row">
            <button class="ghost" id="exportJSON">Export JSON</button>
            <input id="importJSONInput" type="file" accept="application/json" style="display:none" />
            <button class="ghost" id="importJSON">Import JSON</button>
            <button class="ghost" id="exportCSV">Export Daily CSV</button>
            <input id="importCSVInput" type="file" accept=".csv,text/csv" style="display:none" />
            <button class="ghost" id="importCSV">Import CSV</button>
            <button class="warn" id="clearData">Reset All</button>
          </div>
          <div class='row'><button class='primary' id='useEmbeddedCSV'>Import the CSV you attached</button><span class='muted'>We embedded your file — map its columns after clicking.</span></div>
        </div>
        <div class="card">
          <h3>Projection</h3>
          <div class="kpi" id="kpiToday">$0</div>
          <div class="sub">Projected balance as of today</div>
          <div class="spacer"></div>
          <div class="kpi" id="kpiEOY">$0</div>
          <div class="sub">Projected balance on End Date</div>
        </div>
        <div class="card">
          <h3>Totals</h3>
          <div class="row">
            <div>
              <div class="kpi" id="kpiInflows">$0</div>
              <div class="sub">Total inflows within range</div>
            </div>
            <div>
              <div class="kpi" id="kpiOutflows">$0</div>
              <div class="sub">Total outflows within range</div>
            </div>
          </div>
          <div class="spacer"></div>
          <h3>Adjustments</h3>
          <div class="row">
            <input id="adjDate" type="date"/>
            <input id="adjAmount" type="number" step="0.01" placeholder="+/- amount"/>
            <input id="adjMemo" type="text" placeholder="Memo (optional)"/>
            <button class="primary" id="addAdj">Add</button>
          </div>
          <div class="spacer"></div>
          <div style="max-height:150px; overflow:auto;">
            <table id="adjTable">
              <thead><tr><th>Date</th><th class="right">Amount</th><th>Memo</th><th></th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="spacer"></div>

      <div class="card">
        <h3>Balance Curve</h3>
        <div class="chart-wrap"><svg id="balanceChart" class="chart" viewBox="0 0 800 300" preserveAspectRatio="none"></svg></div>
      </div>

      <div class="spacer"></div>

      <div class="card">
        <h3>Next 60 days (net & notable)</h3>
        <div style="max-height:260px; overflow:auto;">
          <table id="upcomingTable">
            <thead>
              <tr><th>Date</th><th class="right">Inflows</th><th class="right">Outflows</th><th class="right">Net</th><th class="right">Balance</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <div class="footer">Pro tip: everything autosaves to your browser only. No servers, no sync.</div>
    </section>

    <!-- EXPENSES / ONE-OFFS -->
    <section class="tab" id="expenses">
      <div class="card">
        <h3>Add one-off item</h3>
        <div class="row">
          <input id="txDate" type="date"/>
          <select id="txType">
            <option value="expense">Expense</option>
            <option value="income">Income (big payment)</option>
          </select>
          <input id="txAmount" type="number" step="0.01" placeholder="Amount"/>
          <input id="txCategory" type="text" placeholder="Category"/>
          <input id="txMemo" type="text" placeholder="Memo (optional)"/>
          <button class="primary" id="addTx">Add</button>
        </div>
      </div>

      <div class="spacer"></div>

      <div class="card">
        <h3>One-offs</h3>
        <div style="max-height:400px; overflow:auto;">
          <table id="txTable">
            <thead>
              <tr><th>Date</th><th>Type</th><th class="right">Amount</th><th>Category</th><th>Memo</th><th></th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- INCOME -->
    <section class="tab" id="income">
      <div class="grid cols-2">
        <div class="card">
          <h3>Recurring weekly income</h3>
          <div class="row">
            <input id="recCat" type="text" placeholder="Category (e.g., Sales A)"/>
            <input id="recAmt" type="number" step="0.01" placeholder="Weekly Amount"/>
            <select id="recDist">
              <option value="even">Evenly across week</option>
              <option value="days">On selected weekdays</option>
            </select>
            <div class="row" id="weekdayPicker" style="display:none">
              <label class="small">Days:</label>
              <label><input type="checkbox" class="wd" value="1">Mon</label>
              <label><input type="checkbox" class="wd" value="2">Tue</label>
              <label><input type="checkbox" class="wd" value="3">Wed</label>
              <label><input type="checkbox" class="wd" value="4">Thu</label>
              <label><input type="checkbox" class="wd" value="5">Fri</label>
              <label><input type="checkbox" class="wd" value="6">Sat</label>
              <label><input type="checkbox" class="wd" value="0">Sun</label>
            </div>
            <button class="primary" id="addRec">Add</button>
          </div>
          <div class="spacer"></div>
          <div style="max-height:300px; overflow:auto;">
            <table id="recTable">
              <thead><tr><th>Category</th><th class="right">Weekly</th><th>Distribution</th><th></th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <div class="card">
          <h3>Daily expected income</h3>
          <div class="row">
            <input id="dIncDate" type="date"/>
            <input id="dIncAmt" type="number" step="0.01" placeholder="Amount"/>
            <input id="dIncCat" type="text" placeholder="Category"/>
            <input id="dIncMemo" type="text" placeholder="Memo (optional)"/>
            <button class="primary" id="addDInc">Add</button>
          </div>
          <div class="spacer"></div>
          <div style="max-height:300px; overflow:auto;">
            <table id="dIncTable">
              <thead><tr><th>Date</th><th class="right">Amount</th><th>Category</th><th>Memo</th><th></th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script src="/app.js"></script>
</body>
</html>

